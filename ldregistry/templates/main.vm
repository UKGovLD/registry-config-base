## Main page which renders all registry views - entities, registers, landing page
##
## Input parameters:
##   $uri     - the requested URI, relative to the registry root (generated by registry-core)
##   $entity  - the URI of a external entity to be displayed, passed as a query parameter, optional
##   $_browse - flag (query parameter) to indicate user has selected "browse"  to override landing page, optional

#set( $isLandingPage = $uri.isEmpty() && !$entity && !${_browse} )

#set( $nav = "#if( $isLandingPage )landing#{else}browse#end" )

#if( $isLandingPage )
    #parse("structure/_preamble.vm")
    ## Replace with alternative landing page views if preferred
    #parse( "main/_page-category.vm")
#else
    #parse( "structure/_header.vm" )
    #parse( "main/_fetch_item.vm" )
    #parse( "nav/_navbar.vm" )
    <div class='container' id="main">
        #parse("structure/_service-bar.vm")
        #if( $render == "item" )
            #parse( "main/_item-render.vm" )
        #elseif( $render == "resource" )
            #parse( "main/_resource-render.vm" )
        #elseif( $render == "not-found" )
            #parse( "main/_not-found.vm" )
        #elseif( $render == "error" )
            #parse( "main/_internal-error.vm" )
        #end
#end

#renderDialogs()

#parse("structure/_footer.vm")
